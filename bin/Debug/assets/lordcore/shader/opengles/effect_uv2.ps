#version 100

uniform sampler2D texSampler;
uniform sampler2D tex1Sampler;
uniform mediump vec3 blendMode[2];
uniform mediump vec3 dissolution;

varying mediump vec4 color;
varying mediump vec2 texCoord;
varying mediump vec2 texCoord1;

void main(void)
{
	mediump vec4 textureColor = texture2D(texSampler, texCoord);
	mediump vec4 texture1Color = texture2D(tex1Sampler, texCoord1);
	mediump vec4 finalColor;
	finalColor.rgb = textureColor.rgb * texture1Color.rgb * blendMode[0].x + textureColor.rgb * blendMode[0].y + texture1Color.rgb * blendMode[0].z;
	finalColor.a = textureColor.a * texture1Color.a * blendMode[1].x + textureColor.a * blendMode[1].y + texture1Color.a * blendMode[1].z;
	gl_FragColor = finalColor * color;
	gl_FragColor.a = (1.0-dissolution.x) * gl_FragColor.a + dissolution.x * gl_FragColor.a * step(dissolution.y,texture1Color.a + dissolution.z); 
}