#version 100
precision mediump float;

//后处理源贴图
uniform sampler2D texSampler;

//Bloom贴图
uniform sampler2D texBloom;

//从播放开始的流逝时间
uniform float elapsedTime;
//各闪电分段的持续时间
uniform vec4 durationTimes;
//UV
varying mediump vec2 texCoord;

void main()
{

	float timeFactor = 1.0;
	if(elapsedTime < durationTimes[0]) //播放第一个闪电
	{
		timeFactor = (elapsedTime)/durationTimes[0];
	}
	else if(elapsedTime < durationTimes[0] + durationTimes[1]) //播放第二个闪电
	{
		timeFactor = (elapsedTime - durationTimes[0])/durationTimes[1];
	}
	else if(elapsedTime < durationTimes[0]+durationTimes[1] + durationTimes[2]) //播放第三个闪电
	{
		timeFactor = (elapsedTime - (durationTimes[0]+durationTimes[1]))/durationTimes[2];
	}
	else if(elapsedTime < durationTimes[0]+ durationTimes[1]+durationTimes[2]+durationTimes[3]) //播放第四个闪电
	{
		timeFactor = (elapsedTime - (durationTimes[0]+durationTimes[1] + durationTimes[2]) )/durationTimes[3];
	}
	
	timeFactor = max(timeFactor,0.0);
	mediump vec4 resColor = texture2D(texSampler,texCoord);
	mediump vec4 BloomColor = texture2D(texBloom, texCoord);	
	gl_FragColor = resColor + BloomColor;//mix(resColor + BloomColor,resColor,timeFactor);
}