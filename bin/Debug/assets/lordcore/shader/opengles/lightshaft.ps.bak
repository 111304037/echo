#version 100

uniform sampler2D texBackBuffer;

uniform mediump vec4 sunPositionCS;

varying mediump vec2 texCoord;

void main(void)
{	
	mediump vec2 sunScreenPos = sunPositionCS.xy;
	mediump float loopNum = 6.0;
	mediump vec2 dirVec =  (sunScreenPos.xy - texCoord.xy) / (loopNum*2.0); 

	mediump vec4 tex = texCoord.xyxy;
	tex.zw += dirVec;
	
	mediump vec4 offset = dirVec.xyxy * 2.0;
	mediump vec4 color = vec4(0.0, 0.0, 0.0, 0.0);
	for( mediump float i=0.0; i<loopNum; )
	{		
		mediump vec4 s0 = texture2D( texBackBuffer , tex.xy );
		color += vec4( s0.rgb *s0.a, s0.a);
		
		mediump vec4 s1 = texture2D( texBackBuffer , tex.zw );
		color += vec4( s1.rgb *s1.a, s1.a);
		
		tex += offset;
		
		i += 1.0;
	}
	gl_FragColor = vec4( color/(2.0*loopNum));
}
